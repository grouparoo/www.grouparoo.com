---
title: "@grouparoo/sqlite"
date: "2021-04-02"
pullQuote: "Learn how to work with the SQLite plugin as a Source or a Destination."
pageNavSelector: "h2"
---

<PluginDocsLinks plugin="SQLite" />

Grouparoo's [SQLite](https://www.sqlite.org/) plugin enables you to import data from one or more SQLite databases or to export data to a SQLite database.

This guide will show you how to work with the SQLite plugin to [create a Source](#creating-a-sqlite-source) to import your data, or to [create a Destination](#creating-a-sqlite-destination) to export your data.

<PluginDocsInstallation plugin="SQLite" />

<PluginDocsCreateApp plugin="SQLite" />

<ValidateAndApplyConfig />

<PluginDocsColumnarSourceIntro plugin="SQLite" />

---

STOPPED HERE

---

#### Table Source Schedule

A schedule is attached to every Source config file by default, commented out. If you want to import data from the source on a schedule (which is the typical behavior), then you should remove the comments and apply the necessary values.

[You can read more about the common options here](/docs/config/sources/community#adding-a-schedule). The SQLite-specific options (those in the `options` object) are:

- `column`: (**required**) The name of the column to use as the high watermark.

A _high watermark_ is a value used for comparison. Grouparoo will only import items where the high watermark column is greater than the largest previously imported high watermark value. For example, let's say you use `updated_at` as your high watermark. Grouparoo will run an import and record the highest value from that column (presumably from the most recently updated record). The next time the import runs, Grouparoo will only consider records where `updated_at` is greater than the previous high watermark value. And it doesn't have to be a date, it just has to be comparable. Another example would be a numeric field, like `version`, in which the value is incremented when changes are made to the record in the Source database.

#### Table Source Properties

After you generate a Source, you'll likely want to add Properties to it. You can do this through the CLI:

    $ grouparoo generate sqlite:table:property first_name --parent users

You can also create properties in a batch when creating the Table Source [using the `--with` option while running the `generate` command](/docs/cli/config#batch-generation).

The Property generator will drop individual files in the `config/properties` directory. Edit these files to match your desired configuration.

The Property config object has several options. [Some are share across all Properties](/docs/config/properties/community#configuring-your-property), while others are more specific to the type of Property generated. A SQLite Table Source has a few unique options. These can be found in the `options` object in the config file. They are:

- `column`: (**required**) The name of the column to use for the Property.
- `aggregationMethod`: (**required**, default: `"exact"`) The type of aggregation method to use when extracting the data. The available options will be added to the generated config file as a comment.
- `sort`: (**required**, default: `null`), // You can sort the results by another column in this table.

A SQLite Table Source also provides the ability to filter your data via the `filters` option. This is a series of rules that will filter data in the database table to find the appropriate value for each Profile for a given Property.

For example, let's say you had a property called `lifetime_value` which summed all the purchases for a given user. Your Source is a `purchases` table that has a `state` column set to either `successful` or `returned`. You may only want to include `successful` purchases. Your `filters` config might look like this:

```js
{
  filters: [{ key: "state", op: "equals", match: "successful" }],
}
```

The available operators (`op`) will be added to the generated config file as a comment near the `filters` section.

### Query Source

A Query Source is a more flexible way to build properties. With a Query Source, you can add custom SQL commands to your Properties, which could pull data from one or more tables in your database.

The unique thing about the way a Query Source works is that there aren't any unique options for the Source itself. But the Schedule and Properties look a little different.

#### Query Source Schedule

Like a [Table Source Schedule](#table-source-schedule), a Query Source Schedule is included with the generated config file, commented. It has a couple unique options:

- `query`: A SQL query to return that tells Grouparoo which Profiles to check each time the interval occurs.
- `propertyId`: The `id` of the Grouparoo Property whose data is returned by `options.query`.

**Be sure that your query only returns one column of data, and that it maps to the Grouparoo Property you set with `options.propertyId`.**

Here's an example:

```js
{
  options: {
    query: "SELECT id FROM users WHERE updated_at >= (NOW() - INTERVAL '2 day')",
    propertyId: "userId"
  }
}
```

#### Query Source Properties

Query Sources are a little simpler when it comes to Properties. You can generate a Property using the CLI:

    $ grouparoo generate sqlite:query:property lifetime_value --parent purchases

This will drop a file at `config/properties/lifetime_value.js`. Edit this file to match your desired configuration.

There is one unique option for Query Source Properties:

- `query`: The query to extract the Property. You can use [mustache variables](https://github.com/janl/mustache.js#variables) to represent the keys of other Properties in the system. You can use the `id` of any other Properties you created in Grouparoo.

Here's an example that sums the values in the `price` column for rows in which the `user_id` column's value matches the value of the Grouparoo Profile's `userId` field (i.e. `userId` is the `id` for the Property in Grouparoo):

```js
{
  options: {
    query: "SELECT SUM(price) from purchases where user_id = {{userId}}";
  }
}
```

## Creating a SQLite Destination

SQLite is one of the few integrations that can be both a Source and a Destination. You can use Grouparoo to export data to a SQLite database. Like a Source, a Destination requires that you've already configured an App to describe the connection details to you SQLite database.

Once your App exists, you can generate the config file for the Destination:

    $ grouparoo generate sqlite:destination my_exports

This would generate a config file at `config/destinations/my_export.js` in your Grouparoo project. Edit this file to match your desired configuration.

The SQLite Destination has a few unique options:

- `table`: The name of the table which Grouparoo which use to export **Profiles**.
- `primaryKey`: The primary key for the specified table.
- `groupsTable`: Grouparoo also exports group memberships. This is the table used to export Group data.
- `groupForeignKey`: The foreign key that the groups table uses to reference the profiles table.
- `groupColumnName`: The column name used to store the Group name values.

## Import and Export SQLite Data

Once you have the plugin installed, App created, and a Source or Destination configured, you are ready to [validate](/docs/cli/config#validate), [apply](/docs/cli/config#apply), then [import or export your data](/docs/cli/run#run)!
